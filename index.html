<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient-start: #e0e7ff;
            --bg-gradient-end: #c7d2fe;
            --card-bg: rgba(255, 255, 255, 0.6);
            --card-border: rgba(255, 255, 255, 0.9);
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --input-bg: rgba(255, 255, 255, 0.7);
            --input-border: #d1d5db;
        }
        html.dark {
            --bg-gradient-start: #111827;
            --bg-gradient-end: #1f2937;
            --card-bg: rgba(31, 41, 55, 0.5);
            --card-border: rgba(55, 65, 81, 0.8);
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --input-bg: rgba(55, 65, 81, 0.7);
            --input-border: #4b5563;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
            background-size: 200% 200%;
            animation: gradient-animation 15s ease infinite;
            transition: background 0.3s ease;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
        }
        .form-input {
            background-color: var(--input-bg) !important;
            border-color: var(--input-border) !important;
        }
        #results {
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        .risk-dial-track { stroke: #e5e7eb; }
        .risk-dial-value {
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 1s cubic-bezier(0.34, 1.56, 0.64, 1), stroke 1s ease;
        }
        html.dark .risk-dial-track { stroke: #4b5563; }
        .flag-item {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake {
            animation: shake 0.3s linear;
        }
    </style>
</head>
<body class="text-[var(--text-primary)]">

    <div class="container mx-auto px-4 py-8 md:py-12 max-w-4xl">
        
        <nav class="flex justify-end items-center mb-10 h-10">
             <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-500/10 focus:outline-none focus:ring-2 focus:ring-blue-500">
                 <svg id="theme-icon-light" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                 <svg id="theme-icon-dark" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
             </button>
        </nav>

        <main class="glass-card rounded-2xl p-6 md:p-8">
            <header class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold">Phishing Analyzer</h2>
                <p class="text-lg text-[var(--text-secondary)] mt-2">Paste email details below to assess threat level.</p>
            </header>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <input type="email" id="senderEmail" class="form-input w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 transition" placeholder="Sender's Email Address">
                <input type="text" id="emailSubject" class="form-input w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 transition" placeholder="Email Subject">
            </div>

            <textarea id="emailContent" rows="12" class="form-input w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 transition" placeholder="Paste the full email content, including links, here..."></textarea>
            
            <div class="text-xs text-[var(--text-secondary)]/80 mt-2">
                Load a sample: 
                <button id="loadPhishingSample" class="text-blue-500 hover:underline">Phishing Email</button> | 
                <button id="loadLegitSample" class="text-blue-500 hover:underline">Legitimate Email</button>
            </div>

            <div class="mt-6 flex flex-col sm:flex-row items-center gap-4">
                <button id="analyzeBtn" class="w-full sm:w-auto flex-1 bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-800 flex items-center justify-center gap-2">
                    <svg id="analyzeIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 13.293A8 8 0 0113.293 17.293l-4.243-4.243a1 1 0 010-1.414l4.243-4.243a8 8 0 114.243 4.243z" /><path d="M12 10a2 2 0 100-4 2 2 0 000 4z" /></svg>
                    <span id="analyzeBtnText">Analyze</span>
                </button>
                <button id="clearBtn" class="w-full sm:w-auto bg-gray-500/20 text-[var(--text-primary)] font-semibold py-3 px-6 rounded-lg hover:bg-gray-500/30 transition">Clear</button>
            </div>
        </main>

        <div id="results" class="opacity-0 transform translate-y-4 mt-10">
            <div class="glass-card rounded-2xl p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 text-center">Analysis Report</h2>
                <div class="grid grid-cols-1 md:grid-cols-5 gap-8 items-center">
                    
                    <div class="md:col-span-2 flex flex-col items-center justify-center">
                        <div class="relative w-48 h-48">
                            <svg class="w-full h-full" viewBox="0 0 100 100">
                                <circle class="risk-dial-track" cx="50" cy="50" r="45" stroke-width="10" fill="transparent"/>
                                <circle id="riskDialValue" class="risk-dial-value" cx="50" cy="50" r="45" stroke-width="10" fill="transparent" transform="rotate(-90 50 50)"/>
                            </svg>
                            <div id="resultScore" class="absolute inset-0 flex flex-col items-center justify-center">
                                <span class="text-4xl font-bold">0</span>
                                <span class="text-sm text-[var(--text-secondary)]">Risk Score</span>
                            </div>
                        </div>
                        <h3 id="resultTitle" class="text-xl font-bold mt-4 text-center"></h3>
                        <p id="resultSummary" class="text-center text-[var(--text-secondary)] -mt-1 mb-2 px-4"></p>
                    </div>

                    <div class="md:col-span-3">
                        <div class="mb-6">
                            <h4 class="font-semibold text-lg border-b border-[var(--input-border)] pb-2 mb-3">Detected Red Flags:</h4>
                            <div id="flagsContainer" class="space-y-3"></div>
                            <p id="noFlags" class="text-[var(--text-secondary)] hidden italic">No specific red flags were detected.</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-lg border-b border-[var(--input-border)] pb-2 mb-3">Recommendations:</h4>
                            <div id="recommendationsContainer" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const senderEmailEl = document.getElementById('senderEmail');
        const emailSubjectEl = document.getElementById('emailSubject');
        const emailContentEl = document.getElementById('emailContent');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const analyzeBtnText = document.getElementById('analyzeBtnText');
        const analyzeIcon = document.getElementById('analyzeIcon');
        const clearBtn = document.getElementById('clearBtn');
        const themeToggle = document.getElementById('theme-toggle');
        const themeIconLight = document.getElementById('theme-icon-light');
        const themeIconDark = document.getElementById('theme-icon-dark');
        
        // Results elements
        const resultsDiv = document.getElementById('results');
        const resultTitle = document.getElementById('resultTitle');
        const resultScore = document.getElementById('resultScore').querySelector('span:first-child');
        const resultSummary = document.getElementById('resultSummary'); // NEW: Get the summary element
        const riskDialValue = document.getElementById('riskDialValue');
        const flagsContainer = document.getElementById('flagsContainer');
        const noFlags = document.getElementById('noFlags');
        const recommendationsContainer = document.getElementById('recommendationsContainer');

        // Sample loaders
        const loadPhishingSampleBtn = document.getElementById('loadPhishingSample');
        const loadLegitSampleBtn = document.getElementById('loadLegitSample');

        // SVG Icons
        const ICONS = {
            sender: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>',
            subject: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v1H7V5zm0 2h2v1H7V7z" clip-rule="evenodd" /></svg>',
            content: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg>',
            links: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" /></svg>',
            recommend_safe: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>',
            recommend_caution: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.22 3.006-1.742 3.006H4.42c-1.522 0-2.492-1.672-1.742-3.006l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-4a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd" /></svg>',
            recommend_danger: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>',
        };

        // --- Analysis Engine ---
        const PHISHING_CHECKS = {
            sender: [
                { regex: /@(microsft|paypa1|gooogle|amazoon|appie|mail-ru|yandex|protonmail|netfIix)\./i, weight: 40, explanation: "Sender's domain is a common misspelling of a legitimate service." },
                { regex: /@(gmail|yahoo|hotmail|outlook|aol)\.com$/i, weight: 15, explanation: "Sender uses a public email provider, which is unusual for official corporate communication." }
            ],
            subject: [
                { regex: /(urgent|action required|suspended|security alert|warning|unauthorized|failed delivery|invoice due)/i, weight: 20, explanation: "Subject line creates a sense of urgency to provoke a quick, emotional response." },
                { regex: /(congratulations|you won|prize|refund|free|winner|claim|gift card)/i, weight: 15, explanation: "Subject line makes an offer that is likely too good to be true." },
            ],
            content: [
                { regex: /(verify|update|confirm|validate|sign in|log in) your (account|password|credentials|information)/ig, weight: 40, explanation: "Requests you to enter login credentials or personal information on a linked page." },
                { regex: /(payment|invoice|wire transfer|credit card|bank account|social security)/ig, weight: 35, explanation: "Asks for sensitive financial details or immediate payment." },
                { regex: /(immediate|within 24 hours|account will be closed|act now|expir\w+\s+soon)/ig, weight: 20, explanation: "Uses threatening language or strict deadlines to rush you into a decision." },
                { regex: /^(dear customer|dear user|valued member|dear account holder|greetings)/im, weight: 10, explanation: "Uses a generic greeting. Legitimate companies will often address you by name." },
                { regex: /(invoice|receipt|document|scan|pdf|zip)\s+is\s+attached|download the attachment/ig, weight: 25, explanation: "Mentions an unexpected attachment, which could contain malware." },
            ],
            links: [
                { weight: 35, explanation: "A link's displayed text does not match its actual destination, hiding a malicious site.",
                    test: (content) => {
                        const linkRegex = /<a\s+(?:[^>]*?\s+)?href="([^"]*)"[^>]*>(.*?)<\/a>/gi;
                        let match;
                        while ((match = linkRegex.exec(content)) !== null) {
                            try {
                                const url = new URL(match[1]);
                                const text = match[2].replace(/<[^>]*>/g, '').trim();
                                // Only check if the link text looks like a URL itself
                                if (text.startsWith('http') || text.startsWith('www.')) {
                                    const textAsUrl = new URL(text.startsWith('http') ? text : `http://${text}`);
                                    if (url.hostname !== textAsUrl.hostname) return true;
                                }
                            } catch (e) { /* ignore invalid urls in text */ }
                        }
                        return false;
                    }
                },
                { regex: /(bit\.ly|t\.co|tinyurl\.com|is\.gd|soo\.gd)/ig, weight: 20, explanation: "Uses a URL shortener, which can obscure the true destination of the link." }
            ]
        };

        // --- Functions ---
        function analyzeEmail() {
            let totalScore = 0;
            const flagsFound = [];
            const checksToRun = { sender: senderEmailEl.value, subject: emailSubjectEl.value, content: emailContentEl.value, links: emailContentEl.value };
            
            // Check for spelling mistakes
            const spellingMistakes = (emailSubjectEl.value + ' ' + emailContentEl.value).match(/temporarilly|congradulations|securty|verfy/gi);
            if(spellingMistakes && spellingMistakes.length > 0) {
                 // MODIFIED: Store weight along with the flag
                totalScore += 15;
                flagsFound.push({ category: 'content', message: 'Contains noticeable spelling or grammar mistakes, a common sign of phishing.', weight: 15 });
            }

            for (const category in PHISHING_CHECKS) {
                const textToAnalyze = checksToRun[category];
                if (!textToAnalyze) continue;

                PHISHING_CHECKS[category].forEach(check => {
                    const testResult = check.regex ? check.regex.test(textToAnalyze) : check.test(textToAnalyze);
                    if (testResult) {
                         // Avoid adding duplicate flag messages
                        if (!flagsFound.some(f => f.message === check.explanation)) {
                            totalScore += check.weight;
                            // MODIFIED: Store the weight along with the flag details
                            flagsFound.push({ category, message: check.explanation, weight: check.weight });
                        }
                    }
                });
            }
            displayResults(Math.min(totalScore, 100), flagsFound);
        }

        function displayResults(score, flags) {
            resultsDiv.style.opacity = '1';
            resultsDiv.style.transform = 'translateY(0)';

            let status, colorClass, textColorClass;

            if (score >= 70) {
                [status, colorClass, textColorClass] = ["High Risk", "stroke-red-500", "text-red-500"];
            } else if (score >= 40) {
                [status, colorClass, textColorClass] = ["Suspicious", "stroke-yellow-500", "text-yellow-500"];
            } else {
                [status, colorClass, textColorClass] = ["Low Risk", "stroke-green-500", "text-green-500"];
            }
            
            resultTitle.textContent = status;
            resultTitle.className = `text-xl font-bold mt-4 text-center ${textColorClass}`;
            
            // NEW: Generate and display the summary of why it was flagged
            resultSummary.innerHTML = ''; // Clear previous summary
            if (flags.length > 0) {
                const sortedFlags = [...flags].sort((a, b) => b.weight - a.weight);
                const primaryCategory = sortedFlags[0].category.charAt(0).toUpperCase() + sortedFlags[0].category.slice(1);
                let summaryText = `The analysis raised concerns regarding the <b>Email ${primaryCategory}</b>.`;
                resultSummary.innerHTML = summaryText;
            } else {
                resultSummary.textContent = "No significant threats were detected."
            }
            
            let currentScore = 0;
            const interval = setInterval(() => {
                currentScore++;
                resultScore.textContent = currentScore;
                if (currentScore >= score) clearInterval(interval);
            }, 10);

            const circumference = 2 * Math.PI * 45;
            const offset = circumference - (score / 100) * circumference;
            riskDialValue.style.strokeDashoffset = offset;
            riskDialValue.className = `risk-dial-value ${colorClass}`;
            
            flagsContainer.innerHTML = '';
            if (flags.length > 0) {
                noFlags.classList.add('hidden');
                flags.forEach((flag, index) => {
                    // MODIFIED: Pass the flag's weight to the list item creator
                    const flagEl = createListItem(ICONS[flag.category], `${flag.category.charAt(0).toUpperCase() + flag.category.slice(1)} Warning`, flag.message, index, flag.weight);
                    flagsContainer.appendChild(flagEl);
                });
            } else {
                noFlags.classList.remove('hidden');
            }

            recommendationsContainer.innerHTML = '';
            getRecommendations(score).forEach((rec, index) => {
                const recEl = createListItem(rec.icon, rec.title, rec.text, index);
                recommendationsContainer.appendChild(recEl);
            });

            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function getRecommendations(score) {
            if (score >= 70) {
                return [
                    { icon: ICONS.recommend_danger, title: "Delete Immediately", text: "Do not reply, forward, or open any attachments. The risk of malware is high." },
                    { icon: ICONS.recommend_danger, title: "Do Not Click Links", text: "Any links in this email are likely malicious and could steal your information." },
                    { icon: ICONS.recommend_danger, title: "Block Sender", text: "Prevent this sender from contacting you again by blocking their email address." }
                ];
            } else if (score >= 40) {
                 return [
                    { icon: ICONS.recommend_caution, title: "Proceed With Extreme Caution", text: "This email contains multiple suspicious indicators. Avoid interaction if possible." },
                    { icon: ICONS.recommend_caution, title: "Verify Sender Independently", text: "Contact the alleged sender through a known, official channel (e.g., their website), not by using contact info from the email." },
                    { icon: ICONS.recommend_caution, title: "Hover Over Links", text: "Before clicking, hover your mouse over any links to see their true destination URL in the bottom corner of your browser." }
                ];
            } else {
                 return [
                    { icon: ICONS.recommend_safe, title: "Looks Safe", text: "Our analysis did not find common signs of phishing. It's likely legitimate." },
                    { icon: ICONS.recommend_safe, title: "Remain Vigilant", text: "Even if an email seems safe, always be cautious about sharing personal information or clicking unfamiliar links." }
                ];
            }
        }
        
        // MODIFIED: Function updated to accept a 'weight' and display it as a badge
        function createListItem(icon, title, text, index, weight) {
            const el = document.createElement('div');
            el.className = 'flex items-start gap-3 flag-item'; 
            el.style.opacity = 0;
            el.style.animationDelay = `${index * 100}ms`;

            // NEW: Create a badge to show the points, but only if a weight is provided
            const weightBadge = weight ? `<span class="ml-2 text-xs font-mono py-0.5 px-1.5 rounded-md bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300">+${weight} pts</span>` : '';

            el.innerHTML = `
                <div class="flex-shrink-0 mt-1">${icon}</div>
                <div>
                    <p class="font-semibold text-[var(--text-primary)]">${title}${weightBadge}</p>
                    <p class="text-sm text-[var(--text-secondary)]">${text}</p>
                </div>`;
            return el;
        }

        function clearInputs() {
            senderEmailEl.value = '';
            emailSubjectEl.value = '';
            emailContentEl.value = '';
            resultsDiv.style.opacity = '0';
            resultsDiv.style.transform = 'translateY(1rem)';
        }

        // --- Event Listeners ---
        analyzeBtn.addEventListener('click', () => {
            if (!senderEmailEl.value && !emailSubjectEl.value && !emailContentEl.value) {
                document.querySelector('main').classList.add('animate-shake');
                setTimeout(() => document.querySelector('main').classList.remove('animate-shake'), 500);
                return;
            }

            analyzeBtnText.textContent = 'Analyzing...';
            analyzeBtn.disabled = true;
            analyzeIcon.innerHTML = `<svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;

            setTimeout(() => { // Simulate analysis time
                analyzeEmail();
                analyzeBtnText.textContent = 'Analyze';
                analyzeBtn.disabled = false;
                analyzeIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 13.293A8 8 0 0113.293 17.293l-4.243-4.243a1 1 0 010-1.414l4.243-4.243a8 8 0 114.243 4.243z" /><path d="M12 10a2 2 0 100-4 2 2 0 000 4z" /></svg>`;
            }, 750);
        });

        clearBtn.addEventListener('click', clearInputs);
        
        // --- Theme Toggle ---
        const setupTheme = () => {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
                themeIconLight.classList.add('hidden');
                themeIconDark.classList.remove('hidden');
            } else {
                document.documentElement.classList.remove('dark');
                themeIconLight.classList.remove('hidden');
                themeIconDark.classList.add('hidden');
            }
        };
        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.theme = isDark ? 'dark' : 'light';
            setupTheme();
        });
        
        // --- Sample Loaders ---
        loadPhishingSampleBtn.addEventListener('click', () => {
            clearInputs();
            senderEmailEl.value = 'security-alert@paypa1.com';
            emailSubjectEl.value = '[Action Required] Your Account Has Been Temporarilly Suspended';
            emailContentEl.value = `Dear Valued Customer,\n\nDue to recent unusual activity, we have detected a potential security risk on your account. For your protection, we have temporarilly suspended access.\n\nYou must verify your identity immediately to avoid permanent closure of your account within 24 hours.\n\nPlease click the link below to login and confirm your details.\n\n<a href="http://bit.ly/login-pp-secure">https://www.paypal.com/restore-account</a>\n\nThank you for your cooperation.\n\nSincerely,\nThe PayPal Security Team`;
        });
        
        loadLegitSampleBtn.addEventListener('click', () => {
            clearInputs();
            senderEmailEl.value = 'no-reply@yourbank.com';
            emailSubjectEl.value = 'Your monthly statement is ready';
            emailContentEl.value = `Hi John Doe,\n\nYour monthly e-statement is now available.\n\nYou can view your statement by logging into your secure online account portal at <a href="https://yourbank.com/login">https://yourbank.com/login</a>. We will never ask you for your password or personal information via email.\n\nFor any questions, please visit our official website.\n\nSincerely,\nYour Bank`;
        });
        
        // Initial setup
        setupTheme();
    </script>
</body>
</html>
